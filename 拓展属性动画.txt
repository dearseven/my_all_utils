import android.animation.Animator;
import android.animation.ValueAnimator;
import android.view.View;

import java.lang.ref.WeakReference;

public class ObjectValueAnimator extends ValueAnimator {
    private WeakReference<View> targetView;

    private ObjectValueAnimator() {
    }

    public void setTargetView(View targetView) {
        this.targetView = new WeakReference(targetView);
    }

    public View getTargetView() {
        return targetView.get();
    }

    public static ObjectValueAnimator ofFloat(ValueAnimator.AnimatorUpdateListener updateListener, float... fls) {
        ObjectValueAnimator o = new ObjectValueAnimator();
        o.setFloatValues(fls);
        updateListener.onAnimationUpdate(o);
        return o;
    }

    public static abstract class OVAnimatorListener implements Animator.AnimatorListener {


        @Override
        public void onAnimationStart(Animator animation) {

        }

        @Override
        public void onAnimationEnd(Animator animation) {

        }

        @Override
        public void onAnimationCancel(Animator animation) {

        }

        @Override
        public void onAnimationRepeat(Animator animation) {

        }
    }
}

//---------------使用---------------------
			View area = mHeadView.findViewById(R.id.headViewImageArea);
            final int extensibleHeight = new ViewPositionAndSizeGetter().calculate(area, this, this).getH();
			//这里直接在构造方法里实现ValueAnimator.AnimatorUpdateListener
            ObjectValueAnimator ova = ObjectValueAnimator.ofFloat(animation -> {
                ObjectValueAnimator ani = (ObjectValueAnimator) animation;
                float fraction = 1f - animation.getAnimatedFraction();
                View view = ani.getTargetView();
                ViewGroup.MarginLayoutParams viewLp = (LinearLayout.LayoutParams) area.getLayoutParams();
                if (fraction == 1f) {
                    viewLp.height = extensibleHeight;
                } else {
                    int height = (int) (viewLp.height * fraction);
                    viewLp.height = height;
                }
                view.setLayoutParams(viewLp);
            },0f, 1f);
            ova.setTargetView(area);
            ova.setDuration(500);
			//OVAnimatorListener，用这个就只用实现自己想要的方法啊，不然一大堆太长了
			ova.addListener(new ObjectValueAnimator.OVAnimatorListener() {
                @Override
                public void onAnimationEnd(Animator animation) {
                    isAnimationRuning = false;
                }
            });
            ova.start();